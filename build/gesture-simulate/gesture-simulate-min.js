YUI.add("gesture-simulate",function(N,M){var t,u,g,M="gesture-simulate",d=N.config.win&&"ontouchstart"in N.config.win&&!(N.UA.phantomjs||N.UA.chrome&&N.UA.chrome<6),s={tap:1,doubletap:1,press:1,move:1,flick:1,pinch:1,rotate:1},a={touchstart:1,touchmove:1,touchend:1,touchcancel:1},r=N.config.doc,I={HOLD_TAP:10,DELAY_TAP:10,HOLD_PRESS:3e3,MIN_HOLD_PRESS:1e3,MAX_HOLD_PRESS:6e4,DISTANCE_MOVE:200,DURATION_MOVE:1e3,MAX_DURATION_MOVE:5e3,MIN_VELOCITY_FLICK:1.3,DISTANCE_FLICK:200,DURATION_FLICK:1e3,MAX_DURATION_FLICK:5e3,DURATION_PINCH:1e3},O="touchstart",D="touchmove",R="touchend",o="mouseup";function e(t){t||N.error(M+": invalid target node"),this.node=t,this.target=N.Node.getDOMNode(t);var t=this.node.getXY(),e=this._getDims();u=t[0]+e[0]/2,g=t[1]+e[1]/2}e.prototype={_toRadian:function(t){return t*(Math.PI/180)},_getDims:function(){var t,e,i;return this.target.getBoundingClientRect?(i="height"in(t=this.target.getBoundingClientRect())?t.height:Math.abs(t.bottom-t.top),e="width"in t?t.width:Math.abs(t.right-t.left)):(e=(t=this.node.get("region")).width,i=t.height),[e,i]},_calculateDefaultPoint:function(t){var e;return N.Lang.isArray(t)&&0!==t.length?(1==t.length&&(e=this._getDims[1],t[1]=e/2),t[0]=this.node.getX()+t[0],t[1]=this.node.getY()+t[1]):t=[u,g],t},rotate:function(t,e,i,n,a,s,r){(!N.Lang.isNumber(i)||!N.Lang.isNumber(n)||i<0||n<0)&&(n=i=this.target.offsetWidth<this.target.offsetHeight?this.target.offsetWidth/4:this.target.offsetHeight/4),N.Lang.isNumber(r)||N.error(M+"Invalid rotation detected."),this.pinch(t,e,i,n,a,s,r)},pinch:function(t,e,i,n,a,s,r){var o,c,h,u,g,d,l,m,_,f,p,L,T,X=0,A=i,E=n,Y={start:[],end:[]},v={start:[],end:[]};if(e=this._calculateDefaultPoint(e),(!N.Lang.isNumber(A)||!N.Lang.isNumber(E)||A<0||E<0)&&N.error(M+"Invalid startRadius and endRadius detected."),(!N.Lang.isNumber(a)||a<=0)&&(a=I.DURATION_PINCH),N.Lang.isNumber(s))for(s%=360;s<0;)s+=360;else s=0;for(N.Lang.isNumber(r)||(r=0),N.AsyncQueue.defaults.timeout=20,o=new N.AsyncQueue,u=e[0],g=e[1],f=(_=s)+r,Y.start=[u+A*Math.sin(this._toRadian(_)),g-A*Math.cos(this._toRadian(_))],Y.end=[u+E*Math.sin(this._toRadian(f)),g-E*Math.cos(this._toRadian(f))],v.start=[u-A*Math.sin(this._toRadian(_)),g+A*Math.cos(this._toRadian(_))],v.end=[u-E*Math.sin(this._toRadian(f)),g+E*Math.cos(this._toRadian(f))],d=1,l=n/i,o.add({fn:function(){var t={pageX:Y.start[0],pageY:Y.start[1],clientX:Y.start[0],clientY:Y.start[1]},e={pageX:v.start[0],pageY:v.start[1],clientX:v.start[0],clientY:v.start[1]},t=this._createTouchList([N.merge({identifier:X++},t),N.merge({identifier:X++},e)]),e={pageX:(Y.start[0]+v.start[0])/2,pageY:(Y.start[0]+v.start[1])/2,clientX:(Y.start[0]+v.start[0])/2,clientY:(Y.start[0]+v.start[1])/2};this._simulateEvent(this.target,O,N.merge({touches:t,targetTouches:t,changedTouches:t,scale:d,rotation:_},e)),2<=N.UA.ios&&this._simulateEvent(this.target,"gesturestart",N.merge({scale:d,rotation:_},e))},timeout:0,context:this}),L=Math.floor(a/20),h=(E-A)/L,m=(l-d)/L,p=(f-_)/L,T=function(t){var e=A+h*t,i=u+e*Math.sin(this._toRadian(_+p*t)),n=g-e*Math.cos(this._toRadian(_+p*t)),a=u-e*Math.sin(this._toRadian(_+p*t)),e=g+e*Math.cos(this._toRadian(_+p*t)),s=(i+a)/2,r=(n+e)/2,a={pageX:a,pageY:e,clientX:a,clientY:e},e=this._createTouchList([N.merge({identifier:X++},{pageX:i,pageY:n,clientX:i,clientY:n}),N.merge({identifier:X++},a)]),i={pageX:s,pageY:r,clientX:s,clientY:r};this._simulateEvent(this.target,D,N.merge({touches:e,targetTouches:e,changedTouches:e,scale:d+m*t,rotation:_+p*t},i)),2<=N.UA.ios&&this._simulateEvent(this.target,"gesturechange",N.merge({scale:d+m*t,rotation:_+p*t},i))},c=0;c<L;c++)o.add({fn:T,args:[c],context:this});o.add({fn:function(){var t=this._getEmptyTouchList(),e={pageX:Y.end[0],pageY:Y.end[1],clientX:Y.end[0],clientY:Y.end[1]},i={pageX:v.end[0],pageY:v.end[1],clientX:v.end[0],clientY:v.end[1]},e=this._createTouchList([N.merge({identifier:X++},e),N.merge({identifier:X++},i)]),i={pageX:(Y.end[0]+v.end[0])/2,pageY:(Y.end[0]+v.end[1])/2,clientX:(Y.end[0]+v.end[0])/2,clientY:(Y.end[0]+v.end[1])/2};2<=N.UA.ios&&this._simulateEvent(this.target,"gestureend",N.merge({scale:l,rotation:f},i)),this._simulateEvent(this.target,R,N.merge({touches:t,targetTouches:t,changedTouches:e,scale:l,rotation:f},i))},context:this}),t&&N.Lang.isFunction(t)&&o.add({fn:t,context:this.node}),o.run()},tap:function(t,e,i,n,a){var s,r,o,c,h,u=new N.AsyncQueue,g=this._getEmptyTouchList();for(e=this._calculateDefaultPoint(e),(!N.Lang.isNumber(i)||i<1)&&(i=1),N.Lang.isNumber(n)||(n=I.HOLD_TAP),N.Lang.isNumber(a)||(a=I.DELAY_TAP),r={pageX:e[0],pageY:e[1],clientX:e[0],clientY:e[1]},s=this._createTouchList([N.merge({identifier:0},r)]),c=function(){this._simulateEvent(this.target,O,N.merge({touches:s,targetTouches:s,changedTouches:s},r))},h=function(){this._simulateEvent(this.target,R,N.merge({touches:g,targetTouches:g,changedTouches:s},r))},o=0;o<i;o++)u.add({fn:c,context:this,timeout:0===o?0:a}),u.add({fn:h,context:this,timeout:n});1<i&&!d&&u.add({fn:function(){this._simulateEvent(this.target,"dblclick",r)},context:this}),t&&N.Lang.isFunction(t)&&u.add({fn:t,context:this.node}),u.run()},flick:function(t,e,i,n,a){e=this._calculateDefaultPoint(e),N.Lang.isString(i)?"x"!==(i=i.toLowerCase())&&"y"!==i&&N.error(M+"(flick): Only x or y axis allowed"):i="x",N.Lang.isNumber(n)||(n=I.DISTANCE_FLICK),N.Lang.isNumber(a)?I.MAX_DURATION_FLICK<a&&(a=I.MAX_DURATION_FLICK):a=I.DURATION_FLICK,Math.abs(n)/a<I.MIN_VELOCITY_FLICK&&(a=Math.abs(n)/I.MIN_VELOCITY_FLICK),i={start:N.clone(e),end:["x"===i?e[0]+n:e[0],"y"===i?e[1]+n:e[1]]},this._move(t,i,a)},move:function(t,e,i){N.Lang.isObject(e)?(N.Lang.isArray(e.point)?e.point=this._calculateDefaultPoint(e.point):e.point=this._calculateDefaultPoint([]),N.Lang.isNumber(e.xdist)||(e.xdist=I.DISTANCE_MOVE),N.Lang.isNumber(e.ydist)||(e.ydist=0)):e={point:this._calculateDefaultPoint([]),xdist:I.DISTANCE_MOVE,ydist:0},N.Lang.isNumber(i)?I.MAX_DURATION_MOVE<i&&(i=I.MAX_DURATION_MOVE):i=I.DURATION_MOVE,e={start:N.clone(
e.point),end:[e.point[0]+e.xdist,e.point[1]+e.ydist]},this._move(t,e,i)},_move:function(t,n,e){var i,a,s,r,o,c,h=0;for(N.Lang.isNumber(e)?I.MAX_DURATION_MOVE<e&&(e=I.MAX_DURATION_MOVE):e=I.DURATION_MOVE,N.Lang.isObject(n)?(N.Lang.isArray(n.start)||(n.start=[u,g]),N.Lang.isArray(n.end)||(n.end=[u+I.DISTANCE_MOVE,g])):n={start:[u,g],end:[u+I.DISTANCE_MOVE,g]},N.AsyncQueue.defaults.timeout=20,(i=new N.AsyncQueue).add({fn:function(){var t={pageX:n.start[0],pageY:n.start[1],clientX:n.start[0],clientY:n.start[1]},e=this._createTouchList([N.merge({identifier:h++},t)]);this._simulateEvent(this.target,O,N.merge({touches:e,targetTouches:e,changedTouches:e},t))},timeout:0,context:this}),s=Math.floor(e/20),r=(n.end[0]-n.start[0])/s,o=(n.end[1]-n.start[1])/s,c=function(t){var e=n.start[0]+r*t,t=n.start[1]+o*t,e={pageX:e,pageY:t,clientX:e,clientY:t},t=this._createTouchList([N.merge({identifier:h++},e)]);this._simulateEvent(this.target,D,N.merge({touches:t,targetTouches:t,changedTouches:t},e))},a=0;a<s;a++)i.add({fn:c,args:[a],context:this});i.add({fn:function(){var t={pageX:n.end[0],pageY:n.end[1],clientX:n.end[0],clientY:n.end[1]},e=this._createTouchList([N.merge({identifier:h},t)]);this._simulateEvent(this.target,D,N.merge({touches:e,targetTouches:e,changedTouches:e},t))},timeout:0,context:this}),i.add({fn:function(){var t={pageX:n.end[0],pageY:n.end[1],clientX:n.end[0],clientY:n.end[1]},e=this._getEmptyTouchList(),i=this._createTouchList([N.merge({identifier:h},t)]);this._simulateEvent(this.target,R,N.merge({touches:e,targetTouches:e,changedTouches:i},t))},context:this}),t&&N.Lang.isFunction(t)&&i.add({fn:t,context:this.node}),i.run()},_getEmptyTouchList:function(){return t=t||this._createTouchList([])},_createTouchList:function(t){var e,i=[],n=this;return t&&N.Lang.isArray(t)?N.UA.android&&4<=N.UA.android||N.UA.ios&&2<=N.UA.ios?(N.each(t,function(t){t.identifier||(t.identifier=0),t.pageX||(t.pageX=0),t.pageY||(t.pageY=0),t.screenX||(t.screenX=0),t.screenY||(t.screenY=0),i.push(r.createTouch(N.config.win,n.target,t.identifier,t.pageX,t.pageY,t.screenX,t.screenY))}),e=r.createTouchList.apply(r,i)):N.UA.ios&&N.UA.ios<2?N.error(M+": No touch event simulation framework present."):(e=[],N.each(t,function(t){t.identifier||(t.identifier=0),t.clientX||(t.clientX=0),t.clientY||(t.clientY=0),t.pageX||(t.pageX=0),t.pageY||(t.pageY=0),t.screenX||(t.screenX=0),t.screenY||(t.screenY=0),e.push({target:n.target,identifier:t.identifier,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY})}),e.item=function(t){return e[t]}):N.error(M+": Invalid touchPoints passed"),e},_simulateEvent:function(t,e,i){var n;!a[e]||d?N.Event.simulate(t,e,i):this._isSingleTouch(i.touches,i.targetTouches,i.changedTouches)?(e={touchstart:"mousedown",touchmove:"mousemove",touchend:o}[e],i.button=0,i.relatedTarget=null,n=e===o?i.changedTouches:i.touches,i=N.mix(i,{screenX:n.item(0).screenX,screenY:n.item(0).screenY,clientX:n.item(0).clientX,clientY:n.item(0).clientY},!0),N.Event.simulate(t,e,i),e==o&&N.Event.simulate(t,"click",i)):N.error("_simulateEvent(): Event '"+e+"' has multi touch objects that can't be simulated in your platform.")},_isSingleTouch:function(t,e,i){return t&&t.length<=1&&e&&e.length<=1&&i&&i.length<=1}},N.GestureSimulation=e,N.GestureSimulation.defaults=I,N.GestureSimulation.GESTURES=s,N.Event.simulateGesture=function(t,e,i,n){t=N.one(t);var a=new N.GestureSimulation(t);if(e=e.toLowerCase(),!n&&N.Lang.isFunction(i)&&(n=i,i={}),i=i||{},s[e])switch(e){case"tap":a.tap(n,i.point,i.times,i.hold,i.delay);break;case"doubletap":a.tap(n,i.point,2);break;case"press":N.Lang.isNumber(i.hold)?i.hold<I.MIN_HOLD_PRESS?i.hold=I.MIN_HOLD_PRESS:i.hold>I.MAX_HOLD_PRESS&&(i.hold=I.MAX_HOLD_PRESS):i.hold=I.HOLD_PRESS,a.tap(n,i.point,1,i.hold);break;case"move":a.move(n,i.path,i.duration);break;case"flick":a.flick(n,i.point,i.axis,i.distance,i.duration);break;case"pinch":a.pinch(n,i.center,i.r1,i.r2,i.duration,i.start,i.rotation);break;case"rotate":a.rotate(n,i.center,i.r1,i.r2,i.duration,i.start,i.rotation)}else N.error(M+": Not a supported gesture simulation: "+e)}},"@VERSION@",{requires:["async-queue","event-simulate","node-screen"]});