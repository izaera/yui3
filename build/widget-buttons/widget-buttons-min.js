YUI.add("widget-buttons",function(r,t){var l=r.Array,e=r.Lang,u=r.Object,h=r.Plugin.Button,n=r.Widget,o=r.WidgetStdMod,s=r.ClassNameManager.getClassName,d=e.isArray,i=e.isNumber,_=e.isString,a=e.isValue;function f(t){return t.getDOMNode}function B(){this._buttonsHandles={}}B.ATTRS={buttons:{getter:"_getButtons",setter:"_setButtons",value:{}},defaultButton:{readOnly:!0,value:null}},B.CLASS_NAMES={button:s("button"),buttons:n.getClassName("buttons"),primary:s("button","primary")},B.HTML_PARSER={buttons:function(t){return this._parseButtons(t)}},B.NON_BUTTON_NODE_CFG=["action","classNames","context","events","isDefault","section"],B.prototype={BUTTONS:{},BUTTONS_TEMPLATE:"<span />",DEFAULT_BUTTONS_SECTION:o.FOOTER,initializer:function(){this._stdModNode||r.error("WidgetStdMod must be added to a Widget before WidgetButtons."),this._mapButtons(this.get("buttons")),this._updateDefaultButton(),this.after({buttonsChange:r.bind("_afterButtonsChange",this),defaultButtonChange:r.bind("_afterDefaultButtonChange",this)}),r.after(this._bindUIButtons,this,"bindUI"),r.after(this._syncUIButtons,this,"syncUI")},destructor:function(){u.each(this._buttonsHandles,function(t){t.detach()}),delete this._buttonsHandles,delete this._buttonsMap,delete this._defaultButton},addButton:function(t,e,n){var o,s=this.get("buttons");return f(t)||(t=this._mergeButtonConfig(t),e=e||t.section),o=s[e=e||this.DEFAULT_BUTTONS_SECTION]||(s[e]=[]),i(n)||(n=o.length),o.splice(n,0,t),n=l.indexOf(o,t),this.set("buttons",s,{button:t,section:e,index:n,src:"add"}),this},getButton:function(t,e){var n,o;if(a(t))return n=this._buttonsMap,e=e||this.DEFAULT_BUTTONS_SECTION,i(t)?(o=this.get("buttons"))[e]&&o[e][t]:1<arguments.length?n[e+":"+t]:n[t]},removeButton:function(n,o){var t,s;return a(n)&&(t=this.get("buttons"),i(n)?(o=o||this.DEFAULT_BUTTONS_SECTION,s=n,n=t[o][s]):(_(n)&&(n=this.getButton.apply(this,arguments)),u.some(t,function(t,e){if(-1<(s=l.indexOf(t,n)))return o=e,!0})),n&&-1<s&&(t[o].splice(s,1),this.set("buttons",t,{button:n,section:o,index:s,src:"remove"}))),this},_bindUIButtons:function(){var t=r.bind("_afterContentChangeButtons",this);this.after({visibleChange:r.bind("_afterVisibleChangeButtons",this),headerContentChange:t,bodyContentChange:t,footerContentChange:t})},_createButton:function(t){var e,n,o,s,u,i,a;if(f(t))return r.one(t.getDOMNode()).plug(h);for(e=r.merge({context:this,events:"click",label:t.value},t),n=r.merge(e),s=0,u=(o=B.NON_BUTTON_NODE_CFG).length;s<u;s+=1)delete n[o[s]];return t=h.createNode(n),i=e.context,a=e.action,_(a)&&(a=r.bind(a,i)),a=t.on(e.events,a,i),this._buttonsHandles[r.stamp(t,!0)]=a,t.setData("name",this._getButtonName(e)),t.setData("default",this._getButtonDefault(e)),l.each(l(e.classNames),t.addClass,t),t},_getButtonContainer:function(t,e){var t=o.SECTION_CLASS_NAMES[t],n=B.CLASS_NAMES.buttons,t=this.get("contentBox").one("."+t+" ."+n);return!t&&e&&(t=r.Node.create(this.BUTTONS_TEMPLATE)).addClass(n),t},_getButtonDefault:function(t){t=f(t)?t.getData("default"):t.isDefault;return _(t)?"true"===t.toLowerCase():!!t},_getButtonName:function(t){t=f(t)?t.getData("name")||t.get("name"):t&&(t.name||t.type);return t},_getButtons:function(t){var n={};return u.each(t,function(t,e){n[e]=t.concat()}),n},_mapButton:function(t,e){var n=this._buttonsMap,o=this._getButtonName(t),s=this._getButtonDefault(t);o&&(n[o]=t,n[e+":"+o]=t),s&&(this._defaultButton=t)},_mapButtons:function(t){this._buttonsMap={},this._defaultButton=null,u.each(t,function(t,e){for(var n=0,o=t.length;n<o;n+=1)this._mapButton(t[n],e)},this)},_mergeButtonConfig:function(t){var e,n;return(t=_(t)?{name:t}:r.merge(t)).srcNode&&(n=(e=t.srcNode).get("tagName").toLowerCase(),n=e.get("input"===n?"value":"text"),e={disabled:!!e.get("disabled"),isDefault:this._getButtonDefault(e),name:this._getButtonName(e)},n&&(e.label=n),r.mix(t,e,!1,null,0,!0)),n=this._getButtonName(t),(e=this.BUTTONS&&this.BUTTONS[n])&&r.mix(t,e,!1,null,0,!0),t},_parseButtons:function(t){var o="."+B.CLASS_NAMES.button,s=null;return l.each(["header","body","footer"],function(t){var e,n=this._getButtonContainer(t),n=n&&n.all(o);n&&!n.isEmpty()&&(e=[],n.each(function(t){e.push({srcNode:t})}),(s=s||{})[t]=e)},this),s},_setButtons:function(t){var i=this.DEFAULT_BUTTONS_SECTION,a={};function e(t,e){if(d(t))for(var n,o,s=0,u=t.length;s<u;s+=1)o=e,f(n=t[s])||(n=this._mergeButtonConfig(n),o=o||n.section),n=this._createButton(n),(a[o=o||i]||(a[o]=[])).push(n)}return d(t)?e.call(this,t):u.each(t,e,this),a},_syncUIButtons:function(){this._uiSetButtons(this.get("buttons")),this._uiSetDefaultButton(this.get("defaultButton")),this._uiSetVisibleButtons(this.get("visible"))},_uiInsertButton:function(t,e,n){var o=B.CLASS_NAMES.button,s=this._getButtonContainer(e,!0),o=s.all("."+o);s.insertBefore(t,o.item(n)),this.setStdModContent(e,s,"after")},_uiRemoveButton:function(t,e,n){var o=r.stamp(t,this),s=this._buttonsHandles,u=s[o];u&&u.detach(),delete s[o],t.remove(),(n=n||{}).preserveContent||(u=this._getButtonContainer(e),o=B.CLASS_NAMES.button,u&&u.all("."+o).isEmpty()&&(u.remove(),this._updateContentButtons(e)))},_uiSetButtons:function(h){var d=B.CLASS_NAMES.button;l.each(["header","body","footer"],function(e){var t,n,o,s,u=h[e]||[],i=u.length,a=this._getButtonContainer(e,i),r=!1;if(a){for(t=a.all("."+d),n=0;n<i;n+=1)o=u[n],-1<(s=t.indexOf(o))?(t.splice(s,1),s!==n&&(a.insertBefore(o,n+1),r=!0)):(a.appendChild(o),r=!0);t.each(function(t){this._uiRemoveButton(t,e,{preserveContent:!0}),r=!0},this),0===i?(a.remove(),this._updateContentButtons(e)):r&&this.setStdModContent(e,a,"after")}},this)},_uiSetDefaultButton:function(t,e){var n=B.CLASS_NAMES.primary;t&&t.addClass(n),e&&e.removeClass(n)},_uiSetVisibleButtons:function(t){!t||(t=this.get("defaultButton"))&&t.focus()},_unMapButton:function(t,e){var n=this._buttonsMap,o=this._getButtonName(t);o&&(n[o]===t&&delete n[o],n[e=e+":"+o]===t&&delete n[e]),this._defaultButton===t&&(this._defaultButton=null)},_updateDefaultButton:function(){
var t=this._defaultButton;this.get("defaultButton")!==t&&this._set("defaultButton",t)},_updateContentButtons:function(t){var e=this.getStdModNode(t).get("childNodes");this.set(t+"Content",e.isEmpty()?null:e,{src:"buttons"})},_afterButtonsChange:function(t){var e,n=t.newVal,o=t.section,s=t.index,u=t.src;"add"===u?(e=n[o][s],this._mapButton(e,o),this._updateDefaultButton(),this._uiInsertButton(e,o,s)):"remove"===u?(e=t.button,this._unMapButton(e,o),this._updateDefaultButton(),this._uiRemoveButton(e,o)):(this._mapButtons(n),this._updateDefaultButton(),this._uiSetButtons(n))},_afterContentChangeButtons:function(t){var e=t.src,t=t.stdModPosition;t&&t!==o.REPLACE||"buttons"===e||e===n.UI_SRC||this._uiSetButtons(this.get("buttons"))},_afterDefaultButtonChange:function(t){this._uiSetDefaultButton(t.newVal,t.prevVal)},_afterVisibleChangeButtons:function(t){this._uiSetVisibleButtons(t.newVal)}},r.WidgetButtons=B},"@VERSION@",{requires:["button-plugin","cssbutton","widget-stdmod"]});